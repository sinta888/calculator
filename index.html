<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>NTU Tuition Fee Calculator</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background-color: #ffffff;
    color: #181C62;
    margin: 0;
    padding: 20px;
  }
  h2 {
    color: #D71440;
  }
  .calculator-step {
    display: none;
    margin-bottom: 20px;
  }
  .calculator-step.active {
    display: block;
  }
  .cost-of-living-qt-base {
    display: block;
    border: 1px solid #c8c8c8;
    border-radius: 6px;
    padding: 15px;
    margin-bottom: 10px;
    cursor: pointer;
  }
  .cost-of-living-qt-base input {
    margin-right: 10px;
  }
  .calculator-buttons {
    margin-top: 15px;
  }
  .edb-pri-btn {
    background-color: #D71440;
    color: #ffffff;
    border: none;
    padding: 10px 20px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
  }
  .edb-pri-btn:disabled {
    background-color: #c8c8c8;
    cursor: not-allowed;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 15px;
  }
  table, th, td {
    border: 1px solid #8c8c8c;
  }
  th, td {
    padding: 8px;
    text-align: left;
  }
  .tooltip-content {
    display: none;
    background-color: #f5f5f5;
    border: 1px solid #c8c8c8;
    padding: 10px;
    border-radius: 4px;
    margin-top: 5px;
  }
  .tooltip:hover .tooltip-content {
    display: block;
  }
</style>
</head>
<body>

<h2>NTU Tuition Fee Calculator</h2>

<!-- Step 1: Programme Type -->
<div class="calculator-step active" id="step-programme">
  <h3>Select Programme</h3>
  <label class="cost-of-living-qt-base">
    <input type="radio" name="programme" value="msc"> MSc Coursework
  </label>
  <label class="cost-of-living-qt-base">
    <input type="radio" name="programme" value="flexi"> Flexi Masters
  </label>
  <div class="calculator-buttons">
    <button class="edb-pri-btn" onclick="nextStep('step-programme')">Next</button>
  </div>
</div>

<!-- Step 2: Student Type -->
<div class="calculator-step" id="step-student-type">
  <h3>Student Type</h3>
  <label class="cost-of-living-qt-base">
    <input type="radio" name="studentType" value="SC"> Singapore Citizen
  </label>
  <label class="cost-of-living-qt-base">
    <input type="radio" name="studentType" value="PR"> Permanent Resident
  </label>
  <label class="cost-of-living-qt-base">
    <input type="radio" name="studentType" value="Intl"> International
  </label>
  <div class="calculator-buttons">
    <button class="edb-pri-btn" onclick="prevStep('step-student-type')">Back</button>
    <button class="edb-pri-btn" onclick="nextStep('step-student-type')">Next</button>
  </div>
</div>

<!-- Step 3: Flexi Masters Funding (conditional) -->
<div class="calculator-step" id="step-funding">
  <h3>Select Funding Type</h3>
  <label class="cost-of-living-qt-base" id="self-funded-label">
    <input type="radio" name="funding" value="self"> Self-funded
  </label>
  <label class="cost-of-living-qt-base" id="company-sponsored-label">
    <input type="radio" name="funding" value="company"> Company-sponsored
  </label>
  <div class="calculator-buttons">
    <button class="edb-pri-btn" onclick="prevStep('step-funding')">Back</button>
    <button class="edb-pri-btn" onclick="nextStep('step-funding')">Next</button>
  </div>
</div>

<!-- Step 4: SkillsFuture / ETSS (conditional) -->
<div class="calculator-step" id="step-sf-etss">
  <h3 id="sf-etss-question">Do you want to use SkillsFuture Credits?</h3>
  <label class="cost-of-living-qt-base">
    <input type="radio" name="sfEtss" value="yes"> Yes
  </label>
  <label class="cost-of-living-qt-base">
    <input type="radio" name="sfEtss" value="no"> No
  </label>
  <div class="calculator-buttons">
    <button class="edb-pri-btn" onclick="prevStep('step-sf-etss')">Back</button>
    <button class="edb-pri-btn" onclick="nextStep('step-sf-etss')">Next</button>
  </div>
</div>

<!-- Step 5: Financial Aid (MSc only) -->
<div class="calculator-step" id="step-financial-aid">
  <h3>Are you eligible for financial aid?</h3>
  <label class="cost-of-living-qt-base">
    <input type="radio" name="financialAid" value="yes"> Yes
    <span class="tooltip">
      <span class="tooltip-content">Up to S$15,000 (includes SC/PR subsidy)</span>
    </span>
  </label>
  <label class="cost-of-living-qt-base">
    <input type="radio" name="financialAid" value="no"> No
  </label>
  <div class="calculator-buttons">
    <button class="edb-pri-btn" onclick="prevStep('step-financial-aid')">Back</button>
    <button class="edb-pri-btn" onclick="nextStep('step-financial-aid')">Next</button>
  </div>
</div>

<!-- Step 6: Result -->
<div class="calculator-step" id="step-result">
  <h3>Estimated Tuition Fee</h3>
  <div id="result-content"></div>
  <div class="calculator-buttons">
    <button class="edb-pri-btn" onclick="startOver()">Start Over</button>
  </div>
</div>

<script>
let currentStep = 0;
const steps = document.querySelectorAll('.calculator-step');

function showStep(index) {
  steps.forEach(step => step.classList.remove('active'));
  if (index >= 0 && index < steps.length) {
    steps[index].classList.add('active');
    currentStep = index;
  }
}

function nextStep(stepId) {
  // Simple logic to skip steps for MSc/Flexi rules
  const programme = document.querySelector('input[name="programme"]:checked')?.value;
  const studentType = document.querySelector('input[name="studentType"]:checked')?.value;
  const funding = document.querySelector('input[name="funding"]:checked')?.value;

  if(stepId === 'step-programme') {
    if(!programme) { alert('Please select a programme'); return; }
    showStep(1);
  } else if(stepId === 'step-student-type') {
    if(!studentType) { alert('Please select a student type'); return; }
    if(programme === 'msc') {
      showStep(5); // skip funding for MSc
    } else if(programme === 'flexi') {
      if(studentType === 'Intl') {
        showStep(6); // skip funding and SF for international
      } else {
        showStep(2); // show funding step
      }
    }
  } else if(stepId === 'step-funding') {
    if(!funding) { alert('Please select funding type'); return; }
    // Flexi logic
    const scPR = (studentType === 'SC' || studentType === 'PR');
    if(scPR) {
      showStep(3); // SkillsFuture / ETSS step
    } else {
      showStep(6); // International
    }
  } else if(stepId === 'step-sf-etss') {
    showStep(6);
  } else if(stepId === 'step-financial-aid') {
    showStep(6);
  }
  calculateResult();
}

function prevStep(stepId) {
  if(stepId === 'step-student-type') showStep(0);
  else if(stepId === 'step-funding') showStep(1);
  else if(stepId === 'step-sf-etss') showStep(2);
  else if(stepId === 'step-financial-aid') showStep(1);
}

function startOver() {
  steps.forEach(step => step.classList.remove('active'));
  steps[0].classList.add('active');
  document.querySelectorAll('input').forEach(input => input.checked = false);
  document.getElementById('result-content').innerHTML = '';
}

function calculateResult() {
  const programme = document.querySelector('input[name="programme"]:checked')?.value;
  const studentType = document.querySelector('input[name="studentType"]:checked')?.value;
  const funding = document.querySelector('input[name="funding"]:checked')?.value;
  const financialAid = document.querySelector('input[name="financialAid"]:checked')?.value;
  const sfEtss = document.querySelector('input[name="sfEtss"]:checked')?.value;

  let html = '';

  if(programme === 'msc') {
    let total = 56156.8;
    let subsidy = 0;
    if(studentType === 'SC' || studentType === 'PR') {
      subsidy += 5000;
      if(financialAid === 'yes') subsidy += 10000; // AY25 onwards: max 15k
    }
    html += `<table>
      <tr><th>Item</th><th>Amount (S$)</th></tr>
      <tr><td>Tuition Fee</td><td>${total.toFixed(2)}</td></tr>
      <tr><td>Subsidy / Financial Aid</td><td>${subsidy.toFixed(2)}</td></tr>
      <tr><td>Payable Tuition Fee</td><td>${(total - subsidy).toFixed(2)}</td></tr>
    </table>`;
  } else if(programme === 'flexi') {
    let total = 28078.40;
    let subsidy = 0;
    let notes = '';

    if(studentType === 'SC' || studentType === 'PR') {
      if(funding === 'self') {
        if(studentType === 'SC') subsidy = 0.7 * total; // 70%
        else if(studentType === 'PR') subsidy = 0.7 * total;
      } else if(funding === 'company') {
        if(studentType === 'SC') subsidy = 0.7 * total; 
        else if(studentType === 'PR') subsidy = 0.7 * total;
      }
    } else {
      // International, no subsidy
      subsidy = 0;
    }

    html += `<table>
      <tr><th>Item</th><th>Amount (S$)</th></tr>
      <tr><td>Programme Fee (incl. GST)</td><td>${total.toFixed(2)}</td></tr>
      <tr><td>Subsidy</td><td>${subsidy.toFixed(2)}</td></tr>
      <tr><td>Payable Fee</td><td>${(total - subsidy).toFixed(2)}</td></tr>
    </table>`;
  }

  document.getElementById('result-content').innerHTML = html;
}
</script>

</body>
</html>
