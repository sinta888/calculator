<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>NTU Tuition Fee Calculator</title>
<style>
  body {
    font-family: Arial, sans-serif;
    display: flex;
    justify-content: center;
    margin: 0;
    padding: 40px;
    background: #f5f5f5;
  }
  .container {
    max-width: 600px;
    width: 100%;
    background: white;
    padding: 30px;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    text-align: center;
  }
  h1 { margin-bottom: 20px; color:#181c62; }
  .step { display: none; text-align: left; margin-top: 20px; }
  .active { display: block; }
  .button-container { text-align: center; margin-top: 20px; }
  button {
    padding: 10px 20px;
    margin: 10px 10px 0 0;
    background-color: #181c62;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 16px;
  }
  button:hover { opacity: 0.9; }
  label { display:block; margin: 8px 0; }
  .result {
    margin-top: 30px;
    padding: 20px;
    border: 1px solid #ccc;
    background: #f9f9f9;
    font-family: monospace;
  }
  .disclaimer { font-size: 12px; color: gray; margin-top: 15px; }
  a { color: #181c62; text-decoration: underline; }
</style>
</head>
<body>
<div class="container">
<h1>NTU Tuition Fee Calculator</h1>

<!-- Step 0: Programme selection -->
<div class="step active" id="step0">
  <h3>Select your programme:</h3>
  <label><input type="radio" name="programme" value="msc"> MSc (Coursework)</label>
  <label><input type="radio" name="programme" value="flexi"> Flexi Masters</label>
  <div class="button-container">
    <button onclick="nextStep(0)">Next</button>
  </div>
</div>

<!-- MSc Coursework Flow -->
<!-- Step 1: Status -->
<div class="step" id="mscStep1">
  <h3>Select your status:</h3>
  <label><input type="radio" name="mscStatus" value="intl"> International Student</label>
  <label><input type="radio" name="mscStatus" value="scspr"> Singapore Citizen / Permanent Resident</label>
  <div class="button-container">
    <button onclick="prevStep('mscStep1')">Back</button>
    <button onclick="nextStep('mscStep1')">Next</button>
  </div>
</div>

<!-- Step 2: Financial Aid (only SC/PR) -->
<div class="step" id="mscStep2">
  <h3>Are you eligible for financial aid? (SC/SPR only)</h3>
  <label><input type="radio" name="mscAid" value="no" checked> No</label>
  <label><input type="radio" name="mscAid" value="yes"> Yes (up to $15,000) <br>
    <small>More info: <a href="https://www.ntu.edu.sg/admissions/graduate/financialmatters/ntupgi#Content_C017_Col00" target="_blank">NTU Financial Aid</a></small>
  </label>
  <div class="button-container">
    <button onclick="prevStep('mscStep2')">Back</button>
    <button onclick="nextStep('mscStep2')">Next</button>
  </div>
</div>

<!-- Step 3: Alumni -->
<div class="step" id="mscStep3">
  <h3>Are you an NTU Alumni?</h3>
  <label><input type="radio" name="mscAlumni" value="no" checked> No</label>
  <label><input type="radio" name="mscAlumni" value="yes"> Yes (10% rebate)</label>
  <div class="button-container">
    <button onclick="prevStep('mscStep3')">Back</button>
    <button onclick="nextStep('mscStep3')">Calculate</button>
  </div>
</div>

<!-- Flexi Masters Flow -->
<!-- Step 1: Status -->
<div class="step" id="flexiStep1">
  <h3>Select your status:</h3>
  <label><input type="radio" name="flexiStatus" value="intl"> International Student</label>
  <label><input type="radio" name="flexiStatus" value="scspr"> Singapore Citizen / Permanent Resident</label>
  <div class="button-container">
    <button onclick="prevStep('flexiStep1')">Back</button>
    <button onclick="nextStep('flexiStep1')">Next</button>
  </div>
</div>

<!-- Step 2: Self-funded or Company-sponsored -->
<div class="step" id="flexiStep2">
  <h3>I am:</h3>
  <label><input type="radio" name="flexiPay" value="self"> Self-funded</label>
  <label><input type="radio" name="flexiPay" value="company"> Company-sponsored</label>
  <div class="button-container">
    <button onclick="prevStep('flexiStep2')">Back</button>
    <button onclick="nextStep('flexiStep2')">Next</button>
  </div>
</div>

<!-- Step 3: Flexi Masters Funding (SC/PR only, self-funded) -->
<div class="step" id="flexiStep3">
  <h3>Select your funding scheme:</h3>
  <label><input type="radio" name="flexiFunding" value="ssg70"> SSG up to 70% (Programme Fee Payable: S$8,423.52)</label>
  <label><input type="radio" name="flexiFunding" value="etss"> ETSS (Programme Fee Payable: S$3,271.52) <br>
    <small>Check eligibility: <a href="https://www.skillsfuture.gov.sg/initiatives/employers/enhanced-training-support-for-smes" target="_blank">ETSS SME</a></small>
  </label>
  <label><input type="radio" name="flexiFunding" value="mces"> MCES â‰¥40yo (Programme Fee Payable: S$3,271.52)</label>
  <div class="button-container">
    <button onclick="prevStep('flexiStep3')">Back</button>
    <button onclick="nextStep('flexiStep3')">Next</button>
  </div>
</div>

<!-- Step 4: Alumni (self-funded only) -->
<div class="step" id="flexiStep4">
  <h3>Are you an NTU Alumni?</h3>
  <label><input type="radio" name="flexiAlumni" value="no" checked> No</label>
  <label><input type="radio" name="flexiAlumni" value="yes"> Yes (Course credits S$1,600 applicable)</label>
  <div class="button-container">
    <button onclick="prevStep('flexiStep4')">Back</button>
    <button onclick="nextStep('flexiStep4')">Next</button>
  </div>
</div>

<!-- Step 5: SkillsFuture Credits (if SC/PR) -->
<div class="step" id="flexiStep5">
  <h3>Do you want to use SkillsFuture Credits?</h3>
  <label><input type="radio" name="flexiSF" value="no" checked> No</label>
  <label><input type="radio" name="flexiSF" value="yes"> Yes, amount: S$ <input type="number" id="sfAmount" min="0" step="1"></label>
  <div class="button-container">
    <button onclick="prevStep('flexiStep5')">Back</button>
    <button onclick="nextStep('flexiStep5')">Calculate</button>
  </div>
</div>

<!-- Step 6: Result -->
<div class="step" id="stepResult">
  <h3>Your Estimated Tuition Fee</h3>
  <div class="result" id="tuitionResult"></div>
  <div class="disclaimer">*This is an estimated calculation. Actual fees may vary based on school policies, GST, funding eligibility, and other considerations.</div>
  <div class="button-container">
    <button onclick="restart()">Start Over</button>
  </div>
</div>

<script>
let tuitionMScBase = 56156.80; // MSc 30 AUs
let tuitionFlexiBase = 28078.40; // Flexi Masters

function nextStep(stepId) {
  // Error handling: must select an option
  let step = document.getElementById(stepId);
  let checked = step.querySelector("input[type='radio']:checked");
  if (!checked) { alert("Please make a selection to proceed."); return; }

  step.classList.remove("active");

  // Determine next step
  if (stepId === "step0") {
    if (checked.value === "msc") document.getElementById("mscStep1").classList.add("active");
    else document.getElementById("flexiStep1").classList.add("active");
  } 
  else if (stepId === "mscStep1") {
    if (checked.value === "intl") document.getElementById("mscStep3").classList.add("active"); // skip aid
    else document.getElementById("mscStep2").classList.add("active");
  } 
  else if (stepId === "mscStep2") document.getElementById("mscStep3").classList.add("active");
  else if (stepId === "mscStep3") document.getElementById("stepResult").classList.add("active");
  else if (stepId === "flexiStep1") document.getElementById("flexiStep2").classList.add("active");
  else if (stepId === "flexiStep2") {
    if (checked.value === "self") document.getElementById("flexiStep3").classList.add("active");
    else document.getElementById("stepResult").classList.add("active"); // company sponsored: skip funding
  }
  else if (stepId === "flexiStep3") document.getElementById("flexiStep4").classList.add("active");
  else if (stepId === "flexiStep4") document.getElementById("flexiStep5").classList.add("active");
  else if (stepId === "flexiStep5") document.getElementById("stepResult").classList.add("active");

  if (stepId === "mscStep3" || stepId === "flexiStep5" || (stepId === "flexiStep2" && checked.value==="company")) calcTuition();
}

function prevStep(stepId) {
  document.getElementById(stepId).classList.remove("active");

  if (stepId === "mscStep1") document.getElementById("step0").classList.add("active");
  else if (stepId === "mscStep2") document.getElementById("mscStep1").classList.add("active");
  else if (stepId === "mscStep3") {
    let status = document.querySelector("input[name='mscStatus']:checked").value;
    if (status==="intl") document.getElementById("mscStep1").classList.add("active");
    else document.getElementById("mscStep2").classList.add("active");
  }
  else if (stepId === "flexiStep1") document.getElementById("step0").classList.add("active");
  else if (stepId === "flexiStep2") document.getElementById("flexiStep1").classList.add("active");
  else if (stepId === "flexiStep3") document.getElementById("flexiStep2").classList.add("active");
  else if (stepId === "flexiStep4") document.getElementById("flexiStep3").classList.add("active");
  else if (stepId === "flexiStep5") document.getElementById("flexiStep4").classList.add("active");
}

function restart() {
  document.querySelectorAll(".step").forEach(s=>s.classList.remove("active"));
  document.getElementById("step0").classList.add("active");
  document.getElementById("tuitionResult").innerHTML = "";
}

// Tuition calculation
function calcTuition() {
  let tuition = 0;
  let programme = document.querySelector("input[name='programme']:checked").value;

  if (programme==="msc") {
    let status = document.querySelector("input[name='mscStatus']:checked").value;
    tuition = tuitionMScBase;
    if (status==="scspr") {
      tuition -= 5000; // base subsidy
      let aid = document.querySelector("input[name='mscAid']:checked").value;
      if (aid==="yes") tuition -= 15000;
    }
    let alumni = document.querySelector("input[name='mscAlumni']:checked").value;
    if (alumni==="yes") tuition *= 0.9;
  } 
  else if (programme==="flexi") {
    let status = document.querySelector("input[name='flexiStatus']:checked").value;
    tuition = tuitionFlexiBase;
    let pay = document.querySelector("input[name='flexiPay']:checked").value;
    if (pay==="self" && status==="scspr") {
      let funding = document.querySelector("input[name='flexiFunding']:checked");
      if (funding) {
        if (funding.value==="ssg70") tuition = 8423.52;
        else if (funding.value==="etss") tuition = 3271.52;
        else if (funding.value==="mces") tuition = 3271.52;
      }
      let alumni = document.querySelector("input[name='flexiAlumni']:checked").value;
      if (alumni==="yes") tuition -= 1600; // course credits
      let useSF = document.querySelector("input[name='flexiSF']:checked").value;
      if (useSF==="yes") {
        let sfAmount = parseFloat(document.getElementById("sfAmount").value) || 0;
        tuition -= sfAmount;
      }
    }
  }

  if (tuition<0) tuition=0;
  document.getElementById("tuitionResult").innerHTML =
    `Base Tuition: S$${tuition.toFixed(2)}<br>Estimated Tuition Payable: S$${tuition.toFixed(2)}`;
}
</script>
</div>
</body>
</html>
